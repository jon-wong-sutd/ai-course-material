<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>TensorFlow feed_dict</title>
  <meta name="description" content="Artificial intelligence (AI) is a rich field spanning formal systems for representing and processing symbolic information, computational models of human cogn...">

  <link rel="stylesheet" href="/ai-course-material/assets/main.css">
  <link rel="canonical" href="/ai-course-material/tensorflow/feeddict/">
  <link rel="alternate" type="application/rss+xml" title="50.021 Artificial Intelligence" href="/ai-course-material/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/ai-course-material/">50.021 Artificial Intelligence</a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/ai-course-material/tensorflow/">Tensorflow</a>
            
          
            
            
            <a class="page-link" href="/ai-course-material/about/">About</a>
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">TensorFlow feed_dict</h1>
  </header>

  <div class="post-content">
    <ul id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#simple-examples-to-start" id="markdown-toc-simple-examples-to-start">Simple Examples to Start</a>    <ul>
      <li><a href="#example-1" id="markdown-toc-example-1">Example 1</a></li>
      <li><a href="#example-2" id="markdown-toc-example-2">Example 2</a></li>
      <li><a href="#example-3" id="markdown-toc-example-3">Example 3</a></li>
      <li><a href="#example-4" id="markdown-toc-example-4">Example 4</a></li>
      <li><a href="#example-5" id="markdown-toc-example-5">Example 5</a></li>
    </ul>
  </li>
  <li><a href="#feed_dict-usage" id="markdown-toc-feed_dict-usage"><code class="highlighter-rouge">feed_dict</code> Usage</a></li>
  <li><a href="#feed_dict-inputs" id="markdown-toc-feed_dict-inputs"><code class="highlighter-rouge">feed_dict</code> Inputs</a></li>
  <li><a href="#complete-code" id="markdown-toc-complete-code">Complete Code</a></li>
  <li><a href="#exercises" id="markdown-toc-exercises">Exercises</a></li>
</ul>

<h1 id="overview">Overview</h1>

<p>In this lesson on <code class="highlighter-rouge">feed_dict</code>, we will demonstrate the use of <code class="highlighter-rouge">feed_dict</code> as well as an important technical detail about its operation.</p>

<p>We’ll be using the “<em>coin flipping</em>” code in <a href="/ai-course-material/tensorflow/namescope">lesson on name scope</a>, and expanding it to allow <em>automated iterations</em> — multiple iterations that can be performed automatically via a for-loop.</p>

<div class="tip">
  <p>Note: The order of the lessons have been changed at the last minute. The “<em>coin flipping</em>” code that this lesson builds on incrementally is now at a “<em>later</em>” lesson <a href="/ai-course-material/tensorflow/namescope">lesson on name scope</a>. You may find it useful to go through the lesson on <em>name scope</em> before looking at this lesson.</p>
</div>

<p>Recall that our “<em>coin flipping</em>” code was only able to perform 1 iteration.</p>

<p>In this lesson, we will use <code class="highlighter-rouge">feed_dict</code> to perform hundreds of iterations of that experiment, each iteration taking in a different “<em>n</em>”.</p>

<h1 id="simple-examples-to-start">Simple Examples to Start</h1>

<p>But first, some simple examples to get you started on <code class="highlighter-rouge">feed_dict</code> in action.</p>

<h2 id="example-1">Example 1</h2>

<p>Note that the Python dict <code class="highlighter-rouge">feed_dict</code> takes in <code class="highlighter-rouge">x</code>. That <code class="highlighter-rouge">x</code> is not some “<em>magic name</em>” that TensorFlow maintains when feeding your inputs to the graph you constructed. It is an actual Python variable <code class="highlighter-rouge">x</code>, which is a <code class="highlighter-rouge">tf.Tensor</code> object that must come out of the construction of a <code class="highlighter-rouge">tf.placeholder</code> <em>node</em>. This will be explained more later.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s">"float"</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">badrun</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">goodrun</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c">#implicit use of a feed dictionary ... what is { ...  }</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">'__main__'</span><span class="p">:</span>
  <span class="n">goodrun</span><span class="p">()</span></code></pre></figure>

<h2 id="example-2">Example 2</h2>

<p>In this example, we introduce dataset.</p>

<p>The <code class="highlighter-rouge">get_feed_dict()</code> method requires you to pass it Python variables <code class="highlighter-rouge">x1</code> and <code class="highlighter-rouge">x2</code> to work. However, the 3rd parameter <code class="highlighter-rouge">dataset</code> is actually not needed, since the Python variable <code class="highlighter-rouge">dataset</code> is global in this case.</p>

<p>It isn’t that <code class="highlighter-rouge">get_feed_dict()</code> is the typical or conventional way to use <code class="highlighter-rouge">feed_dict</code>. The important thing to note is that <code class="highlighter-rouge">feed_dict</code> takes in actual Python variables of type <code class="highlighter-rouge">tf.Tensor</code> that are returned from the construction of <em>node</em> <code class="highlighter-rouge">tf.placeholder</code>.</p>

<p>In fact, the <code class="highlighter-rouge">get_feed_dict()</code> method could have been omitted, and more simply rolled into:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fd</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_x1</span><span class="p">(),</span>  <span class="n">x2</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_x2</span><span class="p">()}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">fd</span><span class="p">)</span></code></pre></figure>

<p>In this example, there is also the concept of <em>dataset mini-batching</em>. This will be explained much later when we discuss how “<em>datasets</em>” are abstracted. The abstraction isn’t some <em>industry convention</em> that you must learn. It is simply some convenience codes that do very simple things:</p>
<ul>
  <li>Maintain a pointer to the current batch (of say 200 data points)</li>
  <li>Gives you the next batch whenever you call method <code class="highlighter-rouge">next_batch()</code></li>
</ul>

<p>You could easily write the above <em>dataset mini-batch dispensing</em> code yourself. In fact, the <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/datasets/mnist.py">MNIST dataset</a>’s <em>dataset mini-batch dispensing</em> code is very simple and small, and deals specifically with how the MNIST data is structured and stored.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">somefakedataset</span><span class="p">():</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dimshape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">get_x1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># for a real dataset it would maintain an internal counter, and return a minibatch of samples</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dimshape</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_x2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dimshape</span><span class="p">)</span>


<span class="n">x1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s">"float"</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s">"float"</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="mf">5.0</span>
<span class="n">dataset</span><span class="o">=</span><span class="n">somefakedataset</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_feed_dict</span><span class="p">(</span><span class="n">placeholder1</span><span class="p">,</span> <span class="n">placeholder2</span><span class="p">,</span><span class="n">dataset</span><span class="p">):</span>
  <span class="c"># a feed dict is a python dictionary, in which placeholder variables are assigned values.</span>
  <span class="c"># usefulness?</span>

  <span class="n">fd</span><span class="o">=</span><span class="p">{</span><span class="n">placeholder1</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_x1</span><span class="p">(),</span>  <span class="n">placeholder2</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_x2</span><span class="p">()}</span>

  <span class="k">return</span> <span class="n">fd</span>

<span class="k">def</span> <span class="nf">goodrun</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">fd</span><span class="o">=</span><span class="n">get_feed_dict</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">fd</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">'__main__'</span><span class="p">:</span>
  <span class="n">goodrun</span><span class="p">()</span></code></pre></figure>

<h2 id="example-3">Example 3</h2>

<p>In this example, we have properly encapsulated all global variables into <code class="highlighter-rouge">coderun()</code>. Once again, note how <code class="highlighter-rouge">feed_dict</code> takes in actual <code class="highlighter-rouge">tf.Tensor</code> objects.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">somefakedataset</span><span class="p">():</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dimshape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">get_x1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># for a real dataset it would maintain an internal counter, and return a minibatch of samples</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dimshape</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_x2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dimshape</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_feed_dict</span><span class="p">(</span><span class="n">placeholder1</span><span class="p">,</span> <span class="n">placeholder2</span><span class="p">,</span><span class="n">dataset</span><span class="p">):</span>
  <span class="c"># a feed dict is a python dictionary, in which placeholder variables are assigned values.</span>
  <span class="c"># usefulness?</span>

  <span class="n">fd</span><span class="o">=</span><span class="p">{</span><span class="n">placeholder1</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_x1</span><span class="p">(),</span>  <span class="n">placeholder2</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_x2</span><span class="p">()}</span>

  <span class="k">return</span> <span class="n">fd</span>

<span class="k">def</span> <span class="nf">codeforrun</span><span class="p">():</span>

  <span class="n">x1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">x2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="mf">5.0</span>
  <span class="n">dataset</span><span class="o">=</span><span class="n">somefakedataset</span><span class="p">()</span>
  <span class="n">fd</span><span class="o">=</span><span class="n">get_feed_dict</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">dataset</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">y</span><span class="p">,</span><span class="n">fd</span>

<span class="k">def</span> <span class="nf">goodrun</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">y</span><span class="p">,</span><span class="n">fd</span><span class="o">=</span><span class="n">codeforrun</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">fd</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">'__main__'</span><span class="p">:</span>
  <span class="n">goodrun</span><span class="p">()</span></code></pre></figure>

<h2 id="example-4">Example 4</h2>

<p>In this final example, we throw in an actual dataset — the <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/datasets/mnist.py">MNIST Dataset</a>.</p>

<p>Don’t worry about the seeming complexity of the MNIST dataset. In a later lesson, we will fully explain the <em>convenience methods</em> in that dataset.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="kn">import</span> <span class="n">mnist</span>

<span class="n">input_data_dir</span><span class="o">=</span> <span class="s">'/tmp/tensorflow/mnist/input_data'</span>

<span class="c">#working with mnist</span>

<span class="k">def</span> <span class="nf">get_datasets</span><span class="p">():</span>
  <span class="n">fake_data</span><span class="o">=</span><span class="bp">False</span>
  <span class="n">data_sets</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="n">input_data_dir</span><span class="p">,</span> <span class="n">fake_data</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">data_sets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">data_sets</span><span class="o">.</span><span class="n">validation</span><span class="p">,</span> <span class="n">data_sets</span><span class="o">.</span><span class="n">test</span>

<span class="k">def</span> <span class="nf">fill_feed_dict</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span> <span class="n">images_plhold</span><span class="p">,</span> <span class="n">labels_plhold</span><span class="p">,</span><span class="n">batchsize</span><span class="p">):</span>
  <span class="s">"""Fills the feed_dict for training the given step.
  A feed_dict takes the form of:
  feed_dict = {
      &lt;placeholder&gt;: &lt;tensor of values to be passed for placeholder&gt;,
      ....
  }
  Args:
    data_set: The set of images and labels, from input_data.read_data_sets()
    images_pl: The images placeholder, from placeholder_inputs().
    labels_pl: The labels placeholder, from placeholder_inputs().
  Returns:
    feed_dict: The feed dictionary mapping from placeholders to values.
  """</span>
  <span class="c"># Create the feed_dict for the placeholders filled with the next</span>
  <span class="c"># `batch size` examples.</span>
  <span class="n">fake_data</span><span class="o">=</span><span class="bp">False</span>
  <span class="n">images_feed</span><span class="p">,</span> <span class="n">labels_feed</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="n">batchsize</span><span class="p">,</span> <span class="n">fake_data</span><span class="p">)</span>

  <span class="n">feed_dict</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">images_plhold</span><span class="p">:</span> <span class="n">images_feed</span><span class="p">,</span>
      <span class="n">labels_plhold</span><span class="p">:</span> <span class="n">labels_feed</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">feed_dict</span>

<span class="k">def</span> <span class="nf">codeforrun2</span><span class="p">(</span><span class="n">batchsize</span><span class="p">):</span>
  <span class="c"># get your datasets</span>
  <span class="n">dstrain</span><span class="p">,</span> <span class="n">dsvalidation</span><span class="p">,</span> <span class="n">dstest</span><span class="o">=</span><span class="n">get_datasets</span><span class="p">()</span>

  <span class="c">#get placeholders</span>
  <span class="n">images_plhold</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span>
  <span class="n">labels_plhold</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span>

  <span class="c">#fill feed dict, that needs all the placeholders, and a dataset</span>
  <span class="n">fd</span><span class="o">=</span><span class="n">fill_feed_dict</span><span class="p">(</span><span class="n">dstrain</span><span class="p">,</span> <span class="n">images_plhold</span><span class="p">,</span> <span class="n">labels_plhold</span><span class="p">,</span><span class="n">batchsize</span><span class="p">)</span>

  <span class="c">#actual operation based on placeholders</span>
  <span class="n">y</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">images_plhold</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">y</span><span class="p">,</span><span class="n">fd</span> <span class="c"># return result tensor, and feed dict</span>

<span class="k">def</span> <span class="nf">codeforrun3</span><span class="p">(</span><span class="n">batchsize</span><span class="p">):</span>
  <span class="c"># get your datasets</span>
  <span class="n">dstrain</span><span class="p">,</span> <span class="n">dsvalidation</span><span class="p">,</span> <span class="n">dstest</span><span class="o">=</span><span class="n">get_datasets</span><span class="p">()</span>

  <span class="c">#get placeholders</span>
  <span class="n">images_plhold</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span>
  <span class="n">labels_plhold</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span>

  <span class="c">#fill feed dict, that needs all the placeholders, and a dataset</span>
  <span class="n">fd</span><span class="o">=</span><span class="n">fill_feed_dict</span><span class="p">(</span><span class="n">dstrain</span><span class="p">,</span> <span class="n">images_plhold</span><span class="p">,</span> <span class="n">labels_plhold</span><span class="p">,</span><span class="n">batchsize</span><span class="p">)</span>

  <span class="c">#actual operation based on placeholders</span>

  <span class="n">y</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">images_plhold</span><span class="p">)</span>
  <span class="n">y</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="n">y</span><span class="p">,[</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">images_plhold</span><span class="p">)])</span>  <span class="c">#images_plhold.get_shape() does not work here - it creates no tensor!!</span>
  <span class="k">return</span> <span class="n">y</span><span class="p">,</span><span class="n">fd</span> <span class="c"># return result tensor, and feed dict</span>

<span class="k">def</span> <span class="nf">goodrun</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c">#get tensor and feed_dict</span>
    <span class="c">#y,fd=codeforrun2(batchsize=10)</span>
    <span class="n">y</span><span class="p">,</span><span class="n">fd</span><span class="o">=</span><span class="n">codeforrun3</span><span class="p">(</span><span class="n">batchsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c">#run with feed_dict</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">fd</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">'__main__'</span><span class="p">:</span>
  <span class="n">goodrun</span><span class="p">()</span></code></pre></figure>

<h2 id="example-5">Example 5</h2>

<p>Here, we show you how <code class="highlighter-rouge">feed_dict</code> is used:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

<span class="kn">import</span> <span class="nn">traceback</span>

<span class="k">def</span> <span class="nf">func_name</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">traceback</span><span class="o">.</span><span class="n">extract_stack</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>


<span class="c">#so far all was a bit boring, we used predefined values to compute something. what is when we wanted to use loaded data??</span>
<span class="c">#how to feed it into a graph - Placeholders</span>

<span class="c">#placeholders are variables, that can be fed with data, when the graph is run via a feed dict</span>


<span class="k">def</span> <span class="nf">op1</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>

  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="s">'someop'</span><span class="p">)</span> <span class="k">as</span> <span class="n">scope</span><span class="p">:</span>
    <span class="n">x3</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"c"</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
    
  <span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">x3</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">op2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>

  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="s">'somevar'</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">'y'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">y</span>



<span class="k">def</span> <span class="nf">foo_name_scoped</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">()</span>
  <span class="k">print</span> <span class="n">name</span><span class="p">,</span> <span class="s">":"</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="s">'foo_name_scoped'</span><span class="p">)</span> <span class="k">as</span> <span class="n">scope</span><span class="p">:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s">"v"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s">"v2"</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">v.name="</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span>
    <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">v2.name="</span><span class="p">,</span> <span class="n">v2</span><span class="o">.</span><span class="n">name</span>
    <span class="n">result_op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
  <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">a.name="</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">name</span>
  <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">b.name="</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">name</span>
  <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">result_op.name="</span><span class="p">,</span> <span class="n">result_op</span><span class="o">.</span><span class="n">name</span>
  <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">foo_variable_scoped</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">func_name</span><span class="p">()</span>
  <span class="k">print</span> <span class="n">name</span><span class="p">,</span> <span class="s">":"</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="s">'foo_variable_scoped'</span><span class="p">)</span> <span class="k">as</span> <span class="n">scope</span><span class="p">:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s">"v"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s">"v2"</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">v.name="</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span>
    <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">v2.name="</span><span class="p">,</span> <span class="n">v2</span><span class="o">.</span><span class="n">name</span>
    <span class="n">result_op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
  <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">a.name="</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">name</span>
  <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">b.name="</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">name</span>
  <span class="k">print</span> <span class="s">"</span><span class="se">\t</span><span class="s">result_op.name="</span><span class="p">,</span> <span class="n">result_op</span><span class="o">.</span><span class="n">name</span>
  <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">goodrun</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s">"float"</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s">"float"</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span><span class="n">foo_name_scoped</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
    <span class="c">#y=foo_variable_scoped(x1,x2)</span>
    <span class="c">#y=op1(x1,x2)</span>
    <span class="c">#y=op2(x1,x2)</span>
    <span class="c">#implicit use of a feed dictionary ... what is { ...  }</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">'__main__'</span><span class="p">:</span>
  <span class="n">goodrun</span><span class="p">()</span></code></pre></figure>

<p>That’s all for the simple examples we have to get you started.</p>

<p><strong>And now, we jump back into explaining <code class="highlighter-rouge">feed_dict</code>.</strong></p>

<h1 id="feed_dict-usage"><code class="highlighter-rouge">feed_dict</code> Usage</h1>

<p>Firstly, how is <code class="highlighter-rouge">feed_dict</code> used?</p>

<div class="tip">
  <p><code class="highlighter-rouge">feed_dict</code> is fed into a <code class="highlighter-rouge">tf.Session</code> run via the parameter <code class="highlighter-rouge">feed_dict</code> in method <code class="highlighter-rouge">tf.Session.run()</code>.</p>
</div>

<p>We see this in the code at line 47:</p>

<pre class="linenos"><code>46
47
</code></pre>

<figure class="highlight"><pre><code class="language-python" data-lang="python">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">300</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">trials</span><span class="p">:</span> <span class="n">get_trials</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">i</span><span class="p">)})</span></code></pre></figure>

<div class="forward">
  <p>The complete code is at the <a href="#complete-code">section Complete Code</a>. You can refer to it as you go through this lesson.</p>
</div>

<h1 id="feed_dict-inputs"><code class="highlighter-rouge">feed_dict</code> Inputs</h1>

<p>The next thing to know about <code class="highlighter-rouge">feed_dict</code> is that it takes in <code class="highlighter-rouge">tf.placeholder</code>-specific <em>tensor</em>s in your graph.</p>

<p>In the following code excerpt, you can see how <code class="highlighter-rouge">tf.placeholder</code>-specific <em>tensor</em> <code class="highlighter-rouge">trials</code> is woven into a graph — it is used as input to generate <em>tensor</em>s <code class="highlighter-rouge">elements_equal_to_value</code>, <code class="highlighter-rouge">as_ints</code>, and <code class="highlighter-rouge">count</code>, which are encapsulated within <em>name scope</em> <code class="highlighter-rouge">count_heads</code>. Eventually <em>tensor</em> <code class="highlighter-rouge">frequency</code> would be generated using <em>tensors</em> in <code class="highlighter-rouge">count_heads</code> and in <code class="highlighter-rouge">get_n</code> as inputs.</p>

<div class="figure">
  <p><img src="/ai-course-material/assets/tensorflow-feeddict/graph.png" alt="Graph" /></p>
</div>

<p>Indeed, that looks like the formula for <a href="https://en.wikipedia.org/wiki/Frequency_(statistics)#Types_of_frequency"><em>relative frequency</em></a> in binomial trials — <em>number of occurrences</em> (of heads, in this case) divided by <em>number of trials</em>.</p>

<p>At line 26, the method <code class="highlighter-rouge">get_experiment()</code> returns <em>tensor</em>s <code class="highlighter-rouge">frequency</code> and <code class="highlighter-rouge">trials</code> to method <code class="highlighter-rouge">run()</code>.</p>

<p>At line 47, <em>tensor</em> <code class="highlighter-rouge">frequency</code> is evaluated, with <em>tensor</em> <code class="highlighter-rouge">trial</code> fed a predetermined value from <code class="highlighter-rouge">get_trials()</code>.</p>

<pre class="linenos"><code>4
.
12
.
14
15
18
.
20
21
.
23
24
25
26
.
36
37
.
40
.
46
47
</code></pre>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">get_experiment</span><span class="p">():</span>

    <span class="n">trials</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'trials'</span><span class="p">)</span> <span class="c"># Trials</span>

    <span class="c"># Count number of 1s (heads) in sample.</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="s">'count_heads'</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">as_ints</span><span class="p">)</span> <span class="c"># Eg. 3</span>

    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="s">'get_n'</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>

    <span class="c"># Calculate relative frequency</span>
    <span class="n">frequency</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">trials</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="n">frequency</span><span class="p">,</span> <span class="n">trials</span> <span class="o">=</span> <span class="n">get_experiment</span><span class="p">()</span> <span class="c"># Build graph, which is the experiment to run.</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">300</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">trials</span><span class="p">:</span> <span class="n">get_trials</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">i</span><span class="p">)})</span></code></pre></figure>

<div class="tip">
  <p><code class="highlighter-rouge">feed_dict</code> takes in keys that are actual <code class="highlighter-rouge">tf.placeholder</code>-specific <code class="highlighter-rouge">tf.Tensor</code> objects in your graph.</p>
</div>

<p>This article intentionally encapsulates the graph within method
<code class="highlighter-rouge">get_experiment()</code> to demonstrate that <code class="highlighter-rouge">feed_dict</code> takes in actual <code class="highlighter-rouge">tf.placeholder</code>-specific <code class="highlighter-rouge">tf.Tensor</code> objects. If <code class="highlighter-rouge">get_experiment()</code> did not return object <code class="highlighter-rouge">trials</code>, line 47 will throw an error saying:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">NameError: name 'trials' is not defined</code></pre></figure>

<p>You can try to see the above by replacing line 40 with:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">    <span class="n">frequency</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_experiment</span><span class="p">()</span></code></pre></figure>

<h1 id="complete-code">Complete Code</h1>

<p>We get <em>n</em> trials of <em>flipping a coin</em> via method <code class="highlighter-rouge">get_trials()</code>.</p>

<p>We then feed those trials into the graph and determine the <a href="https://en.wikipedia.org/wiki/Frequency_(statistics)#Types_of_frequency"><em>relative frequency</em></a> of the occurrence of heads (1 for head; 0 for tail).</p>

<p>The code prints out the <em>relative frequency</em> of occurrence of “<em>head</em>”, which should tend towards 0.5 as <em>n</em> gets larger. Indeed, that seems to happen. But without graphical visualization and smoothing (to show <em>trend direction</em>), we can’t tell for sure.</p>

<p>In the lesson on “TensorFlow Summaries”, we will be able to plot observed values visually.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">get_experiment</span><span class="p">():</span>
    <span class="s">""" Flips a virtual coin n times, and tracks frequency of heads (1) occurring

    Constructs graph.
    Returns [frequency, trials]
      - frequency: the experiment op
      - trials: the placeholder for feed_dict to work
    """</span>
    <span class="n">trials</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'trials'</span><span class="p">)</span> <span class="c"># Trials</span>

    <span class="c"># Count number of 1s (heads) in sample.</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="s">'count_heads'</span><span class="p">):</span>
        <span class="n">elements_equal_to_value</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">trials</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># Eg [true, false, true, true]</span>
        <span class="n">as_ints</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">elements_equal_to_value</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c"># Eg. [1, 0, 1, 1]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">as_ints</span><span class="p">)</span> <span class="c"># Eg. 3</span>

    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="s">'get_n'</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>

    <span class="c"># Calculate relative frequency</span>
    <span class="n">frequency</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">trials</span>

<span class="k">def</span> <span class="nf">get_trials</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="s">"""Gets trials using random function from TensorFlow.
    """</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="n">n</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c"># Trials</span>
    <span class="c"># Run this single tensor, not part of graph from get_experiment()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="c"># Notice that feed_dict (in sess.run()) uses an actual tf.placeholder object!</span>
    <span class="n">frequency</span><span class="p">,</span> <span class="n">trials</span> <span class="o">=</span> <span class="n">get_experiment</span><span class="p">()</span> <span class="c"># Build graph, which is the experiment to run.</span>

    <span class="c"># Write graph to disk.</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">FileWriter</span><span class="p">(</span><span class="s">'./log'</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">300</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">trials</span><span class="p">:</span> <span class="n">get_trials</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">i</span><span class="p">)})</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'n: {}</span><span class="se">\t</span><span class="s">freq: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">result</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">'</span><span class="se">\r</span><span class="s">'</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">sess</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">run</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span></code></pre></figure>

<h1 id="exercises">Exercises</h1>

<p>The use of <code class="highlighter-rouge">feed_dict</code> and <code class="highlighter-rouge">tf.placeholder</code> is simple enough. To get some interesting practice, go through the <a href="/ai-course-material/tensorflow/summaries">lesson on TensorFlow Summaries</a> first, then try plotting some interesting curves using <code class="highlighter-rouge">feed_dict</code>.</p>

<p>In the lesson mentioned, we plot a sine curve, and then plot its square on top for easy comparison.</p>

  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">50.021 Artificial Intelligence</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              50.021 Artificial Intelligence
            
            </li>
            
            <li><a href="mailto:your-email@domain.com">your-email@domain.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/jekyll"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">jekyll</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/jekyllrb"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">jekyllrb</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Artificial intelligence (AI) is a rich field spanning formal systems for representing and processing symbolic information, computational models of human cognition, and a range of techniques for learning, planning and reasoning under uncertainty.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
