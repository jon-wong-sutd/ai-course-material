<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Tensorflow Installation</title>
  <meta name="description" content="Artificial intelligence (AI) is a rich field spanning formal systems for representing and processing symbolic information, computational models of human cogn...">

  <link rel="stylesheet" href="/ai-course-material/assets/main.css">
  <link rel="canonical" href="/ai-course-material/tensorflow/installation/">
  <link rel="alternate" type="application/rss+xml" title="50.021 Artificial Intelligence" href="/ai-course-material/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/ai-course-material/">50.021 Artificial Intelligence</a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/ai-course-material/tensorflow/">Tensorflow</a>
            
          
            
            
            <a class="page-link" href="/ai-course-material/about/">About</a>
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Tensorflow Installation</h1>
  </header>

  <div class="post-content">
    <ul id="markdown-toc">
  <li><a href="#installation" id="markdown-toc-installation">Installation</a>    <ul>
      <li><a href="#installing-python" id="markdown-toc-installing-python">Installing Python</a>        <ul>
          <li><a href="#macos" id="markdown-toc-macos">MacOS</a></li>
          <li><a href="#ubuntu" id="markdown-toc-ubuntu">Ubuntu</a></li>
        </ul>
      </li>
      <li><a href="#fresh-environment" id="markdown-toc-fresh-environment">Fresh Environment</a></li>
      <li><a href="#get-the-source" id="markdown-toc-get-the-source">Get the Source</a></li>
      <li><a href="#configure-the-build" id="markdown-toc-configure-the-build">Configure the Build</a></li>
      <li><a href="#building-the-binary" id="markdown-toc-building-the-binary">Building the Binary</a></li>
      <li><a href="#deploying-the-binary" id="markdown-toc-deploying-the-binary">Deploying the Binary</a></li>
      <li><a href="#validate-the-install" id="markdown-toc-validate-the-install">Validate the Install</a></li>
    </ul>
  </li>
  <li><a href="#reasons-for-using-source" id="markdown-toc-reasons-for-using-source">Reasons for Using Source</a></li>
</ul>

<h1 id="installation">Installation</h1>

<p>The official way to install Tensorflow is described at the <a href="https://www.tensorflow.org/install">Tensorflow Installation Guide</a>. This method installs the official binaries.</p>

<p>If that works for you, you can stay with those official binaries. Then you can skip the rest of this installation guide.</p>

<p>However, I recommend that you build (compile) your own Tensorflow binary from the source. Building your own will only take 1-2 minutes of your time (and 60 minutes of your computer’s time).</p>

<h2 id="installing-python">Installing Python</h2>

<p>We will be installing Python 3 and some required packages. The MacOS and Ubuntu environments are covered.</p>

<p>(If you’re on Windows, keep bugging Jon to write a quick manual on <em>productivity on Linux/MacOS</em>.)</p>

<h3 id="macos">MacOS</h3>

<p>If you’re on a Mac, I recommend the package manager <a href="https://brew.sh">Homebrew</a>.</p>

<p>First, install Homebrew.</p>

<p>Then, install Python 3:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="gp">$ </span>brew install python3
<span class="gp">$ </span>brew install bazel</code></pre></figure>

<h3 id="ubuntu">Ubuntu</h3>

<p>If you’re on Ubuntu, you should already have <code class="highlighter-rouge">python3</code> installed, and you only need to keep it updated. The Python 3 packages you’ll also need are <code class="highlighter-rouge">numpy</code>, <code class="highlighter-rouge">pip</code> and <code class="highlighter-rouge">wheel</code>. We also need <code class="highlighter-rouge">bazel</code>.</p>

<p>First, we need to add bazel’s own APT repo (<a href="https://packages.ubuntu.com">official Ubuntu apt repos</a> don’t have bazel):</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">echo</span> <span class="s2">"deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8"</span> | sudo tee /etc/apt/sources.list.d/bazel.list
sudo apt-get install curl
curl https://bazel.build/bazel-release.pub.gpg | sudo apt-key add -</code></pre></figure>

<p>The commands that’ll get you up-to-date are:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="gp">$ </span>sudo apt-get update
<span class="gp">$ </span>sudo apt-get install bazel
<span class="gp">$ </span>sudo apt-get install python3-numpy python3-dev python3-pip python3-wheel
<span class="gp">$ </span>sudo apt-get -y upgrade</code></pre></figure>

<h2 id="fresh-environment">Fresh Environment</h2>

<p>First, create a virtual environment to do the build.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="gp">$ </span><span class="nb">cd</span> ~/Documents
<span class="gp">$ </span>python3 -m venv --system-site-packages tensorflow.env</code></pre></figure>

<p>Activate the environment with:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="gp">$ </span><span class="nb">source </span>tensorflow.env/bin/activate</code></pre></figure>

<p>You should see your prompt preceded by the name of the fresh environment:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span><span class="c"># Like this</span></code></pre></figure>

<p>You can confirm that you’re using the <code class="highlighter-rouge">python3</code> and <code class="highlighter-rouge">pip3</code> from the fresh environment:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>which python3
<span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>which pip3</code></pre></figure>

<p>Install required packages with:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>pip3 install six numpy wheel</code></pre></figure>

<h2 id="get-the-source">Get the Source</h2>

<p>I hope you already installed Git. Let me know if you need help with that.</p>

<p>Pull the source from GitHub:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>git clone https://github.com/tensorflow/tensorflow
<span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span><span class="nb">cd </span>tensorflow</code></pre></figure>

<h2 id="configure-the-build">Configure the Build</h2>

<p>Set the Python 3 bin path:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span><span class="nb">export </span><span class="nv">PYTHON_BIN_PATH</span><span class="o">=</span>~/Documents/tensorflow.env/bin/python3</code></pre></figure>

<p>Now, configure the build:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>./configure</code></pre></figure>

<p>The first question should be: “<em>Please input the desired Python library path to use</em>”.
Leave as default. Press Enter.</p>

<p>The second question should be about “<em>MKL support</em>”.
Leave as default. Press Enter.</p>

<p>The third question should be about “<em>optimzation flags</em>”, or rather “<em>which hardware to optimize for</em>”.
Leave as default. Press Enter. (the value will be <code class="highlighter-rouge">-march=native</code>)</p>

<p>The fourth to tenth questions are about <em>special hardware</em> optimizations we don’t want to bother with right now.
Leave as default. Press Enter.</p>

<p>We are letting the build process automatically use available optimizations your computer. We won’t be bothering with <em>special hardware</em> optimizations.</p>

<h2 id="building-the-binary">Building the Binary</h2>

<p>Build with <code class="highlighter-rouge">bazel</code>:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>bazel build --config<span class="o">=</span>opt //tensorflow/tools/pip_package:build_pip_package</code></pre></figure>

<p>Set your <em>Energy Savings</em> configuration to “<em>never turn off or sleep</em>”.</p>

<p>Go do something else for 60 minutes (could be longer, like 90 minutes).</p>

<p>When the build is done,</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>mkdir ../tensorflow.env/wheel
<span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>bazel-bin/tensorflow/tools/pip_package/build_pip_package ~/Documents/tensorflow.env/wheel</code></pre></figure>

<h2 id="deploying-the-binary">Deploying the Binary</h2>

<p>We’ll use that same fresh environment we created for the build.</p>

<div class="side-note">
  <p>We’re still operating in that fresh environment. Don’t deactivate this environment now, but you can (later) leave the environment by doing <code class="highlighter-rouge">deactivate</code>.</p>
</div>

<p>Install (aka deploy) the binary:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>pip install ~/Documents/tensorflow.env/wheel/&lt;filename&gt;.whl</code></pre></figure>

<p><code class="highlighter-rouge">&lt;filename&gt;</code> is the filename of the file in <code class="highlighter-rouge">~/Documents/tensorflow.env/wheel/</code> folder. For example, mine is <code class="highlighter-rouge">tensorflow-1.2.0rc0-cp36-cp36m-macosx_10_11_x86_64.whl</code>.</p>

<h2 id="validate-the-install">Validate the Install</h2>

<p>Create a new folder to write some test code:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>mkdir ../test-tensor
<span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span><span class="nb">cd</span> ../test-tensor</code></pre></figure>

<p>Create a new file <code class="highlighter-rouge">test.py</code> with this code:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span> <span class="c"># also tf.float32 implicitly</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]))</span></code></pre></figure>

<p>Execute the code:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="o">(</span>tensorflow.env<span class="o">)</span> <span class="nv">$ </span>python3 test.py</code></pre></figure>

<p>The output should simply be:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Tensor("Const:0", shape=(), dtype=float32) Tensor("Const_1:0", shape=(), dtype=float32)
[3.0, 4.0]</code></pre></figure>

<p>There should be no warnings whatsoever. You can see these would-be warnings (had you used stock binaries) in the next section. Also, the next section explains why it’s best we build our own Tensorflow binary.</p>

<h1 id="reasons-for-using-source">Reasons for Using Source</h1>

<p>If you use the stock binary from the official <a href="https://www.tensorflow.org/install">Tensor Installation Guide</a>, you will run into these warnings:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">... TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine ...
... TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine ...
... TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine ...
... TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine ...
... TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine ...</code></pre></figure>

<p>The stock binaries you can install were not built with certain <em>commonly supported</em> optimizations. Besides running your tensorflow slower than is necessary, your output can also be cluttered by the above warnings.</p>

  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">50.021 Artificial Intelligence</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              50.021 Artificial Intelligence
            
            </li>
            
            <li><a href="mailto:your-email@domain.com">your-email@domain.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/jekyll"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">jekyll</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/jekyllrb"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">jekyllrb</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Artificial intelligence (AI) is a rich field spanning formal systems for representing and processing symbolic information, computational models of human cognition, and a range of techniques for learning, planning and reasoning under uncertainty.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
